%
% CURVAS ELÍPTICAS
%
\section{Curvas Elípticas}

%
% DEFINIÇÃO
%
\subsection{Definição}
Curvas elípticas nada tem a ver com elipses. Elas têm esse nome porque são descritas por equações cúbicas, semelhantes às usadas para calcular a circunferência de uma elipse \cite{Stallings:2011}. Uma curva elíptica \(E\) é um conjunto de soluções de uma equação cúbica definida sobre um corpo \(\mathbb{F}\) é descrita da seguinte forma:
\begin{equation}
y^2 + axy + by = x^3 + cx^2 + dx + e \label{eq:5}
\end{equation}
Onde \(a, b, c, d\) e \(e\) são elementos do corpo \(\mathbb{F}\) e \(x\) e \(y\) são as variáveis da equação e assumem valores dentro de \(\mathbb{F}\). A notação utilizada para indicar que uma curva elíptica \(E\) está definida sobre um corpo \(\mathbb{F}\) é $E(\mathbb{F})$, e o corpo \(\mathbb{F}\) é chamado de corpo subjacente da curva \cite{Guide}. Equações deste tipo são conhecidas como \textit{equações de Weierstrass}. Com frequência, no estudo de criptografia de curvas elípticas, costuma-se utilizar a forma reduzida de Weierstrass, descrita pela equação abaixo, obtida através de uma mudança de variáveis.
\begin{equation}
y^2 = x^3 + ax + b \label{eq:6}
\end{equation}

É imprescindível que os valores de \(a\) e \(b\) sejam escolhidos tais que $4a^3 + 27b^2 \ne 0$ \cite{Mandy:2007}. Essa condição garante que não existe ponto na curva que possua mais de uma reta tangente \cite{Guide}.

O \textbf{conjunto dos pontos} que pertencem à curva elíptica \(E\) definida sobre um corpo \(\mathbb{F}\) é descrito por:

\begin{equation}
E(\mathbb{F}) = \{(x,y) \in \mathbb{F} \times \mathbb{F} \mid y^2 = x^3 + ax + b\} \cup \{\mathcal{O}\}
\label{eq:pontosCurva}
\end{equation}

onde o ponto $\mathcal{O}$ é chamado de \textit{ponto no infinito}. \cite{Mandy:2007}. Será visto na próxima seção que, juntamente com uma operação de soma dos pontos da curva elíptica, o conjunto $E(\mathbb{F})$ forma um grupo abeliano com o ponto no infinito sendo $\mathcal{O}$ o elemento identidade \cite{Guide}.

A Figura \ref{fig:curvas} apresenta alguns exemplos de curvas elípticas usando a forma normal da equação de Weierstrass.

\begin{figure}[h]
\centering
\includegraphics[scale=0.5, bb=0 0 529 101]{figuras/curvas.eps}
\caption{Exemplos de curvas elípticas}
\label{fig:curvas}
\end{figure}

%
% LEIS DE GRUPO PARA CURVAS ELÍPTICAS
%
\subsection{Leis de grupo para Curvas Elípticas}
Seja o conjunto de pontos $E(\mathbb{F})$ da curva elíptica \(E\) definida sobre um corpo \(\mathbb{F}\), é possível definir uma operação sobre esse conjunto de pontos, que será chamada de adição e indicada por $+$. Essa operação de adição e o conjunto de pontos $E(\mathbb{F})$ da curva elíptica formam um grupo abeliano \cite{Stallings:2011}.

A forma mais clara de entender a operação de adição sobre curvas elípticas é geometricamente (ver figura \ref{fig:pontos}). Para somar dois pontos \(P\) e \(Q\) com coordenadas \(x\) diferentes, basta ligar uma linha reta entre eles e encontrar o terceiro ponto de interseção \(R\). Pela natureza das curvas elípticas, pode-se observar que existe um único ponto \(R\) que é o ponto de interseção (a menos que os pontos \(P, Q\) possuam a mesma coordenada $x$ e coordenadas $y$ diferentes). Para formar uma estrutura de grupo, é preciso  definir a adição sobre três pontos da seguinte forma: $P+Q=-R$. \cite{Stallings:2011}

Se as coordenadas \(x\) dos pontos \(P\) e \(Q\) são iguais e as coordenadas $y$ são diferentes, então a reta que passa pelos dois pontos não intersecta a curva elíptica em nenhum outro ponto. Para definir a estrutura de grupo, considera-se que essa reta vertical intersecta a curva no ponto no infinito $\mathcal{O}$. \cite{Stallings:2011}

É possível calcular o dobro de um ponto \(P\), ou seja, calcular a soma do ponto com ele mesmo. Para isso desenha-se a reta tangente à curva no ponto \(P\). Essa linha intersecta a curva elíptica num segundo ponto, que será refletido para obter-se o ponto \(R\), que é o resultado da soma. \cite{Guide} Observe que esse caso se aplica quando se deseja somar os pontos $P$ e $Q$ onde $P=Q$.

\begin{figure}[h]
\includegraphics[scale=0.5, bb=0 0 484 636]{figuras/SomaECC.eps}
\caption{Soma de pontos em curvas elípticas}
\label{fig:pontos}
\end{figure}

Os axiomas de grupo são satisfeitos da seguinte forma:
\begin{enumerate}
  \item Para quaisquer pontos $P, Q \in E(\mathbb{F})$, o ponto $P + Q \in E(\mathbb{F})$.
  \item $\mathcal{O}$ é o elemento identidade. Logo, $P + \mathcal{O} = P$ para todo $P \in E(\mathbb{F})$.
  \item Para qualquer ponto \(P\), existe um ponto $P'$ tal que $P + P' = \mathcal{O}$. O ponto $P'$ é denominado \textit{inverso aditivo} de \(P\).
  \item A adição é associativa. Logo, $P, Q, R \in E(\mathbb{F})$, observa-se que $(P + Q) + R = P + (Q + R)$
  \item A adição é comutativa. Logo, $P, Q \in E(\mathbb{F})$, observa-se que $P + Q = Q + P$.
\end{enumerate}

%
% CURVAS ELÍPTICAS SOBRE CORPO FINITO
%
\subsection{Curvas elípticas sobre corpo finito}
A criptografia de curva elíptica utiliza curvas elípticas em que as variáveis e coeficientes são restritos a elementos de um corpo finito \cite{Stallings:2011}, ou seja, sendo a curva elíptica $E$ definida sobre o corpo finito $\mathbb{F}_p$, seus coeficientes assumem valores inteiros entre 0 e $p - 1$, pois os cálculos são realizados módulo \(p\). Quando definida sobre um corpo finito, a equação da curva deve indicar qual é esse corpo através da notação $mod$, como ocorre na equação \ref{eq:7}, onde a curva está definida sobre um corpo finito $\mathbb{F}_p$.

\begin{equation}
y^2 \mod p = (x^3 + ax + b) \mod p \label{eq:7}
\end{equation}

Pode-se mostrar que um grupo abeliano finito é definido com base no conjunto $E_p(a, b)$, desde que $(x^3 + ax + b) \mod p$ não tenha fatores repetidos. Isso é equivalente à condição

\begin{equation}
(4a^3 + 27b^2) \mod p \neq 0
\end{equation}

A Equação \ref{eq:6} tem a mesma forma da Equação \ref{eq:7}. As regras para adição sobre $E_p(a, b)$ correspondem à técnica algébrica descrita para as curvas elípticas definidas sobre números reais. Para todos os pontos $P, Q \in E_p(a, b)$.

\begin{figure}[h]
\centering
\includegraphics[scale=0.6, bb=0 0 515 478]{figuras/curva_sobre_corpo_finito.eps}
\caption{Curva elíptica $E_{23}(1, 1)$}
\label{fig:curvas}
\end{figure}

\begin{enumerate}
  \item $P + \mathcal{O} = P$.
  \item Se $P = (x_P, y_P)$, então $P + (x_P, -y_P) = \mathcal{O}$. O ponto $(x_P, -y_P)$ é o negativo de \(P\), indicado como \(-P\).
  \item Se $P = (x_P, y_P)$ e $Q = (x_Q, y_Q)$ com $P \neq -Q$, então $R = P + Q = (x_R, y_R)$ é determinado pelas seguintes regras:
    \begin{eqnarray*}
    x_R &=& (\lambda^2 - x_P - x_Q) \mod p \\
    y_R &=& (\lambda(x_P - x_R) - y_P) \mod p
    \end{eqnarray*}
  onde
    \begin{eqnarray*}
    \lambda =
    \begin{cases}
    \left(\dfrac{y_Q - y_P}{x_Q - x_P}\right) \mod p \textrm{, se} \ P \neq Q \\ \\
    \left(\dfrac{3x_P^2 + a}{2y_P}\right) \mod p \textrm{, se} \ P = Q
    \end{cases}
    \end{eqnarray*}
  \item A multiplicação é definida como adição repetida; por exemplo, $4P = P + P + P + P$.
\end{enumerate}

%
% ORDEM DE UMA CURVA ELIPTICA
%
\subsection{Quantidade de pontos em uma curva elíptica}
Seja a curva elíptica $E$ definida sobre o corpo finito $\mathbb{F}_q$. O conjunto de todos os pontos que pertencem à curva elíptica é representado por $E(\mathbb{F}_p)$ (ver \ref{eq:pontosCurva}). A quantidade de pontos que compõe esse conjunto é a \textbf{ordem de $E$ sobre $\mathbb{F}_q$} e será representada pela notação $\#E(\mathbb{F}_q)$. \cite{Guide}

A ordem da curva elíptica é importante para o sistema criptográfico baseado em curvas elípticas, pois sua segurança depende dos fatores primos da ordem \cite{Alvarado:2005}. Se a ordem da curva elíptica pode ser fatorada em números primos pequenos, a sua segurança pode ser facilmente quebrada utilizando o algoritmo de Pohlig-Hellman, que não será abordado em profundidade nesse trabalho.

O teorema de Hasse fornece limites para a ordem de uma curva elíptica. Esse teorema determina que, sendo a curva elíptica $E$ definida sobre $\mathbb{F}_q$, então

\begin{equation}
q + 1 - 2\sqrt{q} \leq \#E(\mathbb{F}_q) \leq q + 1 + 2\sqrt{q}
\label{eq:HasseBounds}
\end{equation}

O \textbf{traço} de $E$ sobre $\mathbb{F}_q$ é $t = 2\sqrt{q}$. Sabendo-se o traço da curva definida sobre $\mathbb{F}_q$, é possível calcular a sua ordem. O algoritmo de Schoof(ver \ref{SchoofAlg}) calcula o traço de uma curva, permitindo saber a sua ordem.

%
% CRIPTOGRAFIA DE CURVAS ELÍPTICAS
%
\subsection{Criptografia de curvas elípticas} \label{sec:ecc}
Primeiro, selecione um inteiro grande \(p\) que seja primo e parâmetros da curva elíptica \(a\) e \(b\) de acordo com a equação \ref{eq:5} ou \ref{eq:6}. Isso define o grupo elíptico de pontos $E_p(a, b)$. Em seguida escolha um ponto base $G \in E_p(a, b)$, cuja a ordem seja um valor muito grande \(n\). $E_p(a, b)$ e \(G\) são os parâmetros do criptossistema, conhecidos por todos os participantes.

Um acordo de chaves entre os usuários \textbf{A} e \textbf{B} pode ser realizado da seguinte maneira:
\begin{enumerate}
\item \textbf{A} seleciona um inteiro \(n_A < n\). Essa é chave privada de \textbf{A}, então \textbf{A} gera sua chave pública $P_A = n_A \times G$
\item Do mesmo modo, \textbf{B} seleciona um inteiro \(n_B < n\), sendo essa a chave privada de \textbf{B}. E então \textbf{B} calcula e divulga sua chave pública $P_B = n_B \times G$.
\item \textbf{A} gera a chave secreta $k = n_A \times P_B$. \textbf{B} gera a chave secreta $k = n_B \times P_A$
\end{enumerate}

Os dois cálculos na etapa 3 produzem o mesmo resultado, porque
\begin{equation*}
n_A \times P_B = n_A \times (n_B \times G) = n_B \times (n_A \times G) = n_B \times P_A
\end{equation*}

Para quebrar esse esquema, um atacante teria de ser capaz de calcular \(k\) a partir de \(kG\), o que é considerado difícil. Este problema é conhecido como \textbf{problema do logaritmo discreto sobre curvas elípticas}.
